[gd_scene load_steps=4 format=3 uid="uid://bkhc2d37hv1ou"]

[ext_resource type="Script" path="res://addons/local_agents/controllers/ChatController.gd" id="1_iul07"]
[ext_resource type="PackedScene" path="res://addons/local_agents/controllers/SavedChatsController.tscn" id="2_j87l4"]

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_pe5a1"]
content_margin_left = 8.0
content_margin_top = 8.0
content_margin_right = 8.0
content_margin_bottom = 8.0

[node name="ChatController" type="Control"]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
size_flags_horizontal = 3
size_flags_vertical = 3
script = ExtResource("1_iul07")

[node name="PanelContainer" type="PanelContainer" parent="."]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="MarginContainer" type="MarginContainer" parent="PanelContainer"]
layout_mode = 2
theme_override_constants/margin_left = 6
theme_override_constants/margin_top = 6
theme_override_constants/margin_right = 6
theme_override_constants/margin_bottom = 6

[node name="RootVBox" type="VBoxContainer" parent="PanelContainer/MarginContainer"]
layout_mode = 2
size_flags_horizontal = 3
size_flags_vertical = 3
custom_constants/separation = 8

[node name="Toolbar" type="HBoxContainer" parent="PanelContainer/MarginContainer/RootVBox"]
layout_mode = 2
size_flags_horizontal = 3
custom_constants/separation = 6

[node name="ModelLabel" type="Label" parent="PanelContainer/MarginContainer/RootVBox/Toolbar"]
layout_mode = 2
text = "Model"

[node name="ModelOptionButton" type="OptionButton" parent="PanelContainer/MarginContainer/RootVBox/Toolbar"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 3

[node name="ManageModelButton" type="Button" parent="PanelContainer/MarginContainer/RootVBox/Toolbar"]
unique_name_in_owner = true
layout_mode = 2
text = "Configure"

[node name="Separator" type="VSeparator" parent="PanelContainer/MarginContainer/RootVBox/Toolbar"]
layout_mode = 2

[node name="InferenceLabel" type="Label" parent="PanelContainer/MarginContainer/RootVBox/Toolbar"]
layout_mode = 2
text = "Inference"

[node name="InferenceOptionButton" type="OptionButton" parent="PanelContainer/MarginContainer/RootVBox/Toolbar"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 3

[node name="ManageInferenceButton" type="Button" parent="PanelContainer/MarginContainer/RootVBox/Toolbar"]
unique_name_in_owner = true
layout_mode = 2
text = "Configure"

[node name="ToolbarSpacer" type="Control" parent="PanelContainer/MarginContainer/RootVBox/Toolbar"]
layout_mode = 2
size_flags_horizontal = 3

[node name="LoadModelButton" type="Button" parent="PanelContainer/MarginContainer/RootVBox/Toolbar"]
unique_name_in_owner = true
layout_mode = 2
text = "Load Model"
size_flags_horizontal = 4

[node name="SavedChatsButton" type="Button" parent="PanelContainer/MarginContainer/RootVBox/Toolbar"]
unique_name_in_owner = true
layout_mode = 2
text = "Saved Chats"

[node name="StatusRow" type="HBoxContainer" parent="PanelContainer/MarginContainer/RootVBox"]
layout_mode = 2
size_flags_horizontal = 3
custom_constants/separation = 6

[node name="StatusLabel" type="Label" parent="PanelContainer/MarginContainer/RootVBox/StatusRow"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 3
text = "Idle"

[node name="ConversationStatusLabel" type="Label" parent="PanelContainer/MarginContainer/RootVBox/StatusRow"]
unique_name_in_owner = true
layout_mode = 2
text = ""

[node name="RuntimeStateLabel" type="Label" parent="PanelContainer/MarginContainer/RootVBox/StatusRow"]
unique_name_in_owner = true
layout_mode = 2
text = "Runtime: unknown"

[node name="SpeechStateLabel" type="Label" parent="PanelContainer/MarginContainer/RootVBox/StatusRow"]
unique_name_in_owner = true
layout_mode = 2
text = "Speech: unknown"

[node name="MainSplit" type="HSplitContainer" parent="PanelContainer/MarginContainer/RootVBox"]
layout_mode = 2
size_flags_horizontal = 3
size_flags_vertical = 3
split_offset = 280

[node name="ConversationsColumn" type="VBoxContainer" parent="PanelContainer/MarginContainer/RootVBox/MainSplit"]
layout_mode = 2
size_flags_horizontal = 1
size_flags_vertical = 3
custom_constants/separation = 6

[node name="ConversationHeader" type="Label" parent="PanelContainer/MarginContainer/RootVBox/MainSplit/ConversationsColumn"]
layout_mode = 2
text = "Conversations"

[node name="ConversationList" type="ItemList" parent="PanelContainer/MarginContainer/RootVBox/MainSplit/ConversationsColumn"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 3
size_flags_vertical = 3
allow_reselect = true
select_mode = 0

[node name="ConversationButtons" type="HBoxContainer" parent="PanelContainer/MarginContainer/RootVBox/MainSplit/ConversationsColumn"]
layout_mode = 2
custom_constants/separation = 6

[node name="NewConversationButton" type="Button" parent="PanelContainer/MarginContainer/RootVBox/MainSplit/ConversationsColumn/ConversationButtons"]
unique_name_in_owner = true
layout_mode = 2
text = "New"
size_flags_horizontal = 3

[node name="RenameConversationButton" type="Button" parent="PanelContainer/MarginContainer/RootVBox/MainSplit/ConversationsColumn/ConversationButtons"]
unique_name_in_owner = true
layout_mode = 2
text = "Rename"
size_flags_horizontal = 3

[node name="DeleteConversationButton" type="Button" parent="PanelContainer/MarginContainer/RootVBox/MainSplit/ConversationsColumn/ConversationButtons"]
unique_name_in_owner = true
layout_mode = 2
text = "Delete"
size_flags_horizontal = 3

[node name="GraphPanel" type="Panel" parent="PanelContainer/MarginContainer/RootVBox/MainSplit/ConversationsColumn"]
layout_mode = 2
size_flags_horizontal = 3
size_flags_vertical = 3
theme_override_styles/panel = SubResource("StyleBoxFlat_pe5a1")

[node name="ConversationGraph" type="Tree" parent="PanelContainer/MarginContainer/RootVBox/MainSplit/ConversationsColumn/GraphPanel"]
unique_name_in_owner = true
anchor_right = 1.0
anchor_bottom = 1.0
margin_left = 4.0
margin_top = 4.0
margin_right = -4.0
margin_bottom = -4.0
hide_root = true

[node name="ChatColumn" type="VBoxContainer" parent="PanelContainer/MarginContainer/RootVBox/MainSplit"]
layout_mode = 2
size_flags_horizontal = 3
size_flags_vertical = 3
custom_constants/separation = 6

[node name="HistoryPanel" type="Panel" parent="PanelContainer/MarginContainer/RootVBox/MainSplit/ChatColumn"]
layout_mode = 2
size_flags_horizontal = 3
size_flags_vertical = 3
theme_override_styles/panel = SubResource("StyleBoxFlat_pe5a1")

[node name="ModelOutputRichTextLabel" type="RichTextLabel" parent="PanelContainer/MarginContainer/RootVBox/MainSplit/ChatColumn/HistoryPanel"]
unique_name_in_owner = true
anchor_right = 1.0
anchor_bottom = 1.0
margin_left = 4.0
margin_top = 4.0
margin_right = -4.0
margin_bottom = -4.0
fit_content = false
scroll_following = true
selection_enabled = true
bbcode_enabled = true

[node name="InputPanel" type="Panel" parent="PanelContainer/MarginContainer/RootVBox/MainSplit/ChatColumn"]
layout_mode = 2
size_flags_horizontal = 3
size_flags_vertical = 1
theme_override_styles/panel = SubResource("StyleBoxFlat_pe5a1")

[node name="InputVBox" type="VBoxContainer" parent="PanelContainer/MarginContainer/RootVBox/MainSplit/ChatColumn/InputPanel"]
layout_mode = 2
size_flags_horizontal = 3
size_flags_vertical = 3
custom_constants/separation = 6

[node name="PromptTextEdit" type="TextEdit" parent="PanelContainer/MarginContainer/RootVBox/MainSplit/ChatColumn/InputPanel/InputVBox"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 3
size_flags_vertical = 3
placeholder_text = "Type a prompt and press Ctrl+Enter to send"
wrap_mode = 1

[node name="InputButtons" type="HBoxContainer" parent="PanelContainer/MarginContainer/RootVBox/MainSplit/ChatColumn/InputPanel/InputVBox"]
layout_mode = 2
size_flags_horizontal = 3
custom_constants/separation = 6

[node name="SendButton" type="Button" parent="PanelContainer/MarginContainer/RootVBox/MainSplit/ChatColumn/InputPanel/InputVBox/InputButtons"]
unique_name_in_owner = true
layout_mode = 2
text = "Send"
size_flags_horizontal = 3

[node name="ClearButton" type="Button" parent="PanelContainer/MarginContainer/RootVBox/MainSplit/ChatColumn/InputPanel/InputVBox/InputButtons"]
unique_name_in_owner = true
layout_mode = 2
text = "Clear"
size_flags_horizontal = 3

[node name="SavedChatsWindow" type="Window" parent="."]
unique_name_in_owner = true
initial_position = 2
size = Vector2i(420, 520)
title = "Saved Conversations"
visible = false

[node name="SavedChatsController" parent="SavedChatsWindow" instance=ExtResource("2_j87l4")]
unique_name_in_owner = true

[node name="RenameConversationWindow" type="Window" parent="."]
unique_name_in_owner = true
initial_position = 2
size = Vector2i(360, 160)
title = "Rename Conversation"
visible = false

[node name="RenameRoot" type="VBoxContainer" parent="RenameConversationWindow"]
layout_mode = 2
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
theme_override_constants/separation = 8
margin_left = 12.0
margin_top = 12.0
margin_right = -12.0
margin_bottom = -12.0

[node name="RenameInstruction" type="Label" parent="RenameConversationWindow/RenameRoot"]
layout_mode = 2
text = "Conversation Name"

[node name="RenameLineEdit" type="LineEdit" parent="RenameConversationWindow/RenameRoot"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 3

[node name="RenameButtons" type="HBoxContainer" parent="RenameConversationWindow/RenameRoot"]
layout_mode = 2
custom_constants/separation = 8

[node name="RenameCancelButton" type="Button" parent="RenameConversationWindow/RenameRoot/RenameButtons"]
unique_name_in_owner = true
layout_mode = 2
text = "Cancel"
size_flags_horizontal = 3

[node name="RenameConfirmButton" type="Button" parent="RenameConversationWindow/RenameRoot/RenameButtons"]
unique_name_in_owner = true
layout_mode = 2
text = "Save"
size_flags_horizontal = 3
